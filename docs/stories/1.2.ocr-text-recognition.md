# 故事 1.2: OCR 文字識別功能 (MVP版)

## 狀態
Ready for Review

## 使用者故事
**作為一個** 老年使用者（爺爺或奶奶），
**我希望** 上傳照片後系統能嘗試識別照片中的文字內容，
**這樣我就能** 看到照片中的文字被轉換成基本的數位文字，如果識別失敗也能繼續使用其他功能。

## 驗收標準 (MVP版)

1. 使用者點擊「上傳照片」按鈕後，可以選擇照片
2. 系統接收照片並顯示簡單的「處理中...」訊息
3. 系統使用 Tesseract.js 對照片進行基本 OCR 文字識別
4. 如果 OCR 成功，顯示識別出的原始文字內容
5. 如果 OCR 失敗或超過 180 秒，顯示「識別失敗」訊息並進入故事生成器
6. 系統支援基本圖片格式（JPG, PNG）

## 任務/子任務 (MVP版)

- [x] 任務 1: 基礎文件上傳處理 (驗收標準: 1, 2, 6)
  - [x] 添加基本圖片格式驗證 (JPG, PNG)
  - [x] 實現簡單載入狀態顯示

- [x] 任務 2: 基礎 OCR 功能整合 (驗收標準: 3, 4, 5)
  - [x] 基礎 Tesseract.js 整合
  - [x] 實現 180 秒超時機制
  - [x] 基本成功/失敗處理

- [x] 任務 3: 基本結果顯示 (驗收標準: 4)
  - [x] 顯示原始 OCR 識別文字
  - [x] 基本錯誤訊息顯示

- [x] 任務 4: 故事生成器銜接 (驗收標準: 5)
  - [x] OCR 失敗時觸發故事生成器
  - [x] 基本流程轉換

## 開發者筆記 (MVP版)

### 前一個故事的洞察
[來源: docs/stories/1.1.basic-user-interface-setup.md#開發代理記錄]

**Story 1.1 關鍵技術決策:**
- 採用傳統 HTML/CSS/JS 架構，而非 React/Vue.js 框架
- 已建立 PresbytopiaAssistant 主類別
- 文件上傳基礎功能已實現 (photo-upload)
- 載入狀態機制已存在 (showLoading/hideLoading)

### MVP 技術需求
[來源: docs/architecture/2-技術棧-technical-stack.md]

**OCR 服務模組 (簡化版):**
- 使用 Tesseract.js 進行基本前端 OCR 處理
- OCR 超時設定：180 秒自動觸發故事生成器
- OCR 失敗時簡單觸發故事生成器
- 支援基本圖片格式 (JPG, PNG)

**MVP 數據流程:**
1. 使用者上傳照片
2. 基本 OCR 處理 (180秒內)
3. 成功：顯示原始文字
4. 失敗：顯示「識別失敗」並進入故事生成器

### 文件位置
- 主要邏輯：/js/main.js (PresbytopiaAssistant 類別)
- HTML 結構：/index.html (使用現有上傳元素)
- 樣式：/css/styles.css (最小樣式需求)

### 測試需求 (MVP)
- 基本 OCR 成功/失敗測試
- 180 秒超時機制驗證
- 基本錯誤訊息顯示

## 變更日誌

| 日期 | 版本 | 描述 | 作者 |
|------|------|------|------|
| 2025-09-05 | 1.0 | 初始故事創建 | Bob (敏捷教練) |
| 2025-09-06 | 2.0 | 重構為 MVP 版本 | Bob (敏捷教練) |

## 開發代理記錄 (MVP版)

### MVP 版本說明
**重構日期**: 2025-09-06  
**重構目標**: 將複雜的 OCR 實現簡化為 MVP 版本，專注核心功能  
**開發語言**: 中文 (Traditional Chinese)

### MVP 實現重點
- 基本 Tesseract.js 整合
- 180 秒簡單超時機制  
- 基本成功/失敗處理
- 原始文字顯示，無格式化
- 簡化的故事生成器銜接

### MVP 檔案修改範圍
- **js/main.js** - 簡化 OCR 處理邏輯
- **css/styles.css** - 基本樣式需求  
- 移除複雜的測試驗證頁面和進階功能

### MVP 狀態
**狀態**: 已完成 - 所有 MVP 功能已實現並測試

### 代理模型使用
**Agent Model Used**: James (dev) - Full Stack Developer

### Debug Log 參考
- OCR 處理流程已實現並測試
- 180 秒超時機制正常運作
- 故事生成器銜接正常
- 語法檢查通過

### 完成筆記清單
1. ✅ 基礎文件上傳處理 - 圖片格式驗證 (JPG, PNG) 和載入狀態
2. ✅ 基礎 OCR 功能整合 - Tesseract.js 整合、180秒超時、成功/失敗處理
3. ✅ 基本結果顯示 - 原始 OCR 文字顯示、錯誤訊息處理
4. ✅ 故事生成器銜接 - OCR 失敗時觸發、基本流程轉換
5. ✅ 語法驗證和測試 - JavaScript 語法檢查通過

### 檔案清單
**修改的檔案:**
- `index.html` - 新增 Tesseract.js CDN、新增 OCR 結果顯示區域
- `js/main.js` - 實現完整 OCR 功能、圖片格式驗證、錯誤處理
- `css/styles.css` - 新增 OCR 結果顯示樣式

**新增的功能:**
- OCR 文字識別功能 (MVP版)
- 圖片格式驗證機制
- 180 秒超時處理
- 原始文字結果顯示
- 基本錯誤訊息處理
- 故事生成器銜接

### 變更日誌
| 日期 | 版本 | 描述 | 作者 |
|------|------|------|------|
| 2025-09-05 | 1.0 | 初始故事創建 | Bob (敏捷教練) |
| 2025-09-06 | 2.0 | 重構為 MVP 版本 | Bob (敏捷教練) |
| 2025-09-06 | 3.0 | MVP 功能完成實現 | James (開發者) |