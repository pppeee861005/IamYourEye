<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>角色切換測試</title>
    <style>
        body { font-family: Arial, sans-serif; margin: 20px; }
        .test-section { margin: 20px 0; padding: 15px; border: 1px solid #ccc; }
        .test-input { width: 100%; padding: 10px; margin: 10px 0; }
        .test-btn { padding: 10px 20px; margin: 5px; background: #007bff; color: white; border: none; cursor: pointer; }
        .result { margin: 10px 0; padding: 10px; background: #f8f9fa; }
    </style>
</head>
<body>
    <h1>AI 聊天機器人角色切換測試</h1>

    <div class="test-section">
        <h3>測試 1: 一般對話 (應該切換到小安)</h3>
        <input type="text" class="test-input" id="test1-input" placeholder="輸入一般對話內容">
        <button class="test-btn" onclick="testRoleSwitching('general')">測試</button>
        <div class="result" id="test1-result"></div>
    </div>

    <div class="test-section">
        <h3>測試 2: 醫療內容 (應該切換到智能醫師)</h3>
        <input type="text" class="test-input" id="test2-input" placeholder="輸入醫療相關內容">
        <button class="test-btn" onclick="testRoleSwitching('medical')">測試</button>
        <div class="result" id="test2-result"></div>
    </div>

    <div class="test-section">
        <h3>測試 3: 詐騙內容 (應該切換到智能防詐警察)</h3>
        <input type="text" class="test-input" id="test3-input" placeholder="輸入詐騙相關內容">
        <button class="test-btn" onclick="testRoleSwitching('fraud')">測試</button>
        <div class="result" id="test3-result"></div>
    </div>

    <div class="test-section">
        <h3>測試 4: 多輪對話一致性</h3>
        <div id="conversation-history"></div>
        <input type="text" class="test-input" id="test4-input" placeholder="繼續對話測試角色一致性">
        <button class="test-btn" onclick="testConversationConsistency()">發送</button>
        <div class="result" id="test4-result"></div>
    </div>

    <script type="module">
        // 模擬測試函數
        window.testRoleSwitching = function(type) {
            const inputId = `test${type === 'general' ? 1 : type === 'medical' ? 2 : 3}-input`;
            const resultId = `test${type === 'general' ? 1 : type === 'medical' ? 2 : 3}-result`;
            const input = document.getElementById(inputId);
            const result = document.getElementById(resultId);

            const message = input.value.trim();
            if (!message) {
                result.innerHTML = '<span style="color: red;">請輸入測試內容</span>';
                return;
            }

            // 模擬角色判斷
            let expectedRole = '小安';
            if (type === 'medical') {
                expectedRole = '智能醫師';
            } else if (type === 'fraud') {
                expectedRole = '智能防詐警察';
            }

            result.innerHTML = `
                <strong>輸入:</strong> ${message}<br>
                <strong>預期角色:</strong> ${expectedRole}<br>
                <strong>測試結果:</strong> <span style="color: green;">角色切換邏輯正常</span>
            `;
        };

        window.testConversationConsistency = function() {
            const input = document.getElementById('test4-input');
            const result = document.getElementById('test4-result');
            const history = document.getElementById('conversation-history');

            const message = input.value.trim();
            if (!message) return;

            // 添加到對話歷史
            const messageDiv = document.createElement('div');
            messageDiv.innerHTML = `<strong>用戶:</strong> ${message}`;
            history.appendChild(messageDiv);

            // 模擬回應
            const responseDiv = document.createElement('div');
            responseDiv.innerHTML = `<strong>AI:</strong> 這是測試回應，角色應該保持一致`;
            responseDiv.style.marginLeft = '20px';
            history.appendChild(responseDiv);

            input.value = '';
            result.innerHTML = '<span style="color: green;">對話一致性測試通過</span>';
        };
    </script>
</body>
</html>
